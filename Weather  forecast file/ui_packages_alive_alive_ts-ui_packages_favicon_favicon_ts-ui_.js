"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["ui_packages_alive_alive_ts-ui_packages_favicon_favicon_ts-ui_packages_hotkey_keyboard-shortcu-30cc64"],{15930:(e,t,n)=>{let r;n.d(t,{H:()=>g});var i=n(10204);let AliveSession=class AliveSession extends i.ib{getUrlFromRefreshUrl(){return s(this.refreshUrl)}constructor(e,t,n,r,i){super(e,()=>this.getUrlFromRefreshUrl(),n,r,void 0,i),this.refreshUrl=t}};async function s(e){let t=await o(e);return t&&t.url&&t.token?a(t.url,t.token):null}async function o(e){let t=await fetch(e,{headers:{Accept:"application/json"}});if(t.ok)return t.json();if(404===t.status)return null;throw Error("fetch error")}async function a(e,t){let n=await fetch(e,{method:"POST",mode:"same-origin",headers:{"Scoped-CSRF-Token":t}});if(n.ok)return n.text();throw Error("fetch error")}var c=n(70170),l=n(75028),u=n(80688),d=n(23683),f=n(75632);function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function p(e,{channel:t,type:n,data:r}){for(let i of e)i.dispatchEvent(new CustomEvent(`socket:${n}`,{bubbles:!1,cancelable:!1,detail:{name:t,data:r}}))}let b=class AliveSessionProxy{subscribe(e){let t=this.subscriptions.add(...e);t.length&&this.worker.port.postMessage({subscribe:t});let n=new Set(t.map(e=>e.name)),r=e.reduce((e,t)=>{let r=t.topic.name;return(0,i.JR)(r)&&!n.has(r)&&e.add(r),e},new Set);r.size&&this.worker.port.postMessage({requestPresence:Array.from(r)})}unsubscribeAll(...e){let t=this.subscriptions.drain(...e);t.length&&this.worker.port.postMessage({unsubscribe:t});let n=this.presenceMetadata.removeSubscribers(e);this.sendPresenceMetadataUpdate(n)}updatePresenceMetadata(e){let t=new Set;for(let n of e)this.presenceMetadata.setMetadata(n),t.add(n.channelName);this.sendPresenceMetadataUpdate(t)}sendPresenceMetadataUpdate(e){if(!e.size)return;let t=[];for(let n of e)t.push({channelName:n,metadata:this.presenceMetadata.getChannelMetadata(n)});this.worker.port.postMessage({updatePresenceMetadata:t})}online(){this.worker.port.postMessage({online:!0})}offline(){this.worker.port.postMessage({online:!1})}hangup(){this.worker.port.postMessage({hangup:!0})}receive(e){let{channel:t}=e;if("presence"===e.type){let n=this.notifyPresenceDebouncedByChannel.get(t);n||(n=(0,c.s)((e,n)=>{this.notify(e,n),this.notifyPresenceDebouncedByChannel.delete(t)},100),this.notifyPresenceDebouncedByChannel.set(t,n)),n(this.subscriptions.subscribers(t),e);return}this.notify(this.subscriptions.subscribers(t),e)}constructor(e,t,n,r,s,o){h(this,"worker",void 0),h(this,"subscriptions",new i.m0),h(this,"presenceMetadata",new i.VH),h(this,"notify",void 0),h(this,"notifyPresenceDebouncedByChannel",new Map),this.notify=s,this.worker=new SharedWorker(`${e}?module=true`,{name:`github-socket-worker-v3-${r}`,type:"module"}),this.worker.port.onmessage=({data:e})=>this.receive(e),this.worker.port.postMessage({connect:{url:t,refreshUrl:n,options:o}})}};async function m(){let e=function(){let e=document.head.querySelector("link[rel=shared-web-socket-src]")?.getAttribute("href");return e&&e.startsWith("/")?e:null}();if(!e)return;let t=document.head.querySelector("link[rel=shared-web-socket]")?.href??null;if(!t)return;let n=document.head.querySelector("link[rel=shared-web-socket]")?.getAttribute("data-refresh-url")??null;if(!n)return;let r=document.head.querySelector("link[rel=shared-web-socket]")?.getAttribute("data-session-id")??null;if(!r)return;let i=(()=>{let i=(0,f.G7)("alive_legacy_retries")?{socketPolicy:{timeout:4e3,attempts:7}}:{};if(!(0,d.nr)()&&"SharedWorker"in window&&"true"!==(0,u.A)("localStorage").getItem("bypassSharedWorker"))try{return new b(e,t,n,r,p,i)}catch{}return new AliveSession(t,n,!1,p,i)})();return window.addEventListener("online",()=>i.online()),window.addEventListener("offline",()=>i.offline()),window.addEventListener("pagehide",()=>{"hangup"in i&&i.hangup()}),i}async function w(){return await l.G,m()}function g(){return r||(r=w())}},78500:(e,t,n)=>{function r(){return{favicon:document.querySelector('.js-site-favicon[type="image/svg+xml"]'),faviconFallback:document.querySelector('.js-site-favicon[type="image/png"]')}}function i(e){let{favicon:t,faviconFallback:n}=r();if(!t||!n)return;let i=c();e=e.substr(0,e.lastIndexOf(".")),e=`${e}${i}.svg`,t.href=e;let s=t.href.substr(0,t.href.lastIndexOf("."));n.href=`${s}.png`}function s(){let{favicon:e,faviconFallback:t}=r();if(!e||!t)return;let n=c(),i=e.href.indexOf("-dark.svg"),s=e.href.substr(0,-1!==i?i:e.href.lastIndexOf("."));e.href=`${s}${n}.svg`,t.href=`${s}${n}.png`}function o(e){let{favicon:t,faviconFallback:n}=r();if(!t||!n)return;let i=t.getAttribute("data-base-href"),s="default"===e?"":`-${e}`,o=c();i&&(t.href=`${i}${s}${o}.svg`,n.href=`${i}${s}${o}.png`)}function a(){o("default")}function c(){return window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"-dark":""}n.d(t,{Ow:()=>i,gd:()=>a,iD:()=>o,uQ:()=>s})},96884:(e,t,n)=>{n.d(t,{Fr:()=>o,U0:()=>c,xl:()=>a});var r=n(47584);let i={Android:"Android",iOS:"iOS",macOS:"macOS",Windows:"Windows",Linux:"Linux",Unknown:"Unknown"};function s(){let e=i.Unknown,t=!1;if(r.cg){let n=r.cg.navigator,s="";try{s=n.userAgent}catch{}let o="";try{o=n?.userAgentData?.platform||n.platform}catch{}-1!==["Macintosh","MacIntel","MacPPC","Mac68K","macOS"].indexOf(o)?e=i.macOS:-1!==["iPhone","iPad","iPod"].indexOf(o)?e=i.iOS:-1!==["Win32","Win64","Windows","WinCE"].indexOf(o)?e=i.Windows:/Android/.test(s)?e=i.Android:/Linux/.test(o)&&(e=i.Linux),t=n?.userAgentData?.mobile??(e===i.Android||e===i.iOS)}return{os:e,isAndroid:e===i.Android,isIOS:e===i.iOS,isMacOS:e===i.macOS,isWindows:e===i.Windows,isLinux:e===i.Linux,isDesktop:e===i.macOS||e===i.Windows||e===i.Linux,isMobile:t}}function o(){return s().isMobile}function a(){return s().isDesktop}function c(){return s().isMacOS}},91752:(e,t,n)=>{n.d(t,{$$:()=>c,GI:()=>o,zw:()=>s});var r=n(96884),i=n(50210);let s=()=>{if("undefined"==typeof document)return!1;let e=document.querySelector("meta[name=keyboard-shortcuts-preference]");return!e||"all"===e.content},o=e=>/Enter|Arrow|Escape|Meta|Control|Mod|Esc/.test(e)||!(0,r.U0)()&&e.includes("Alt")&&e.includes("Shift"),a=new Set(["button","checkbox","color","file","hidden","image","radio","range","reset","submit"]),c=e=>{let t=(0,i.Vy)(e),n=s()&&!function(e){if(!(e instanceof HTMLElement))return!1;let t=e.nodeName.toLowerCase(),n=e.getAttribute("type")?.toLowerCase()??"text",r="true"===e.ariaReadOnly||"true"===e.getAttribute("aria-readonly")||null!==e.getAttribute("readonly");return("select"===t||"textarea"===t||"input"===t&&!a.has(n)||e.isContentEditable)&&!r}(e.target);return o(t)||n}},46988:(e,t,n)=>{let r;n.d(t,{BI:()=>h,Ti:()=>p,lA:()=>f});var i=n(70837),s=n(18679),o=n(80688),a=n(57516);let{getItem:c}=(0,o.A)("localStorage"),l="dimension_",u=["utm_source","utm_medium","utm_campaign","utm_term","utm_content","scid"];try{let e=(0,i.O)("octolytics");delete e.baseContext,r=new s.s(e)}catch{}function d(e){let t=(0,i.O)("octolytics").baseContext||{};if(t)for(let[e,n]of(delete t.app_id,delete t.event_url,delete t.host,Object.entries(t)))e.startsWith(l)&&(t[e.replace(l,"")]=n,delete t[e]);let n=document.querySelector("meta[name=visitor-payload]");for(let[e,r]of(n&&Object.assign(t,JSON.parse(atob(n.content))),new URLSearchParams(window.location.search)))u.includes(e.toLowerCase())&&(t[e]=r);return t.staff=(0,a.X)().toString(),Object.assign(t,e)}function f(e){r?.sendPageView(d(e))}function h(e,t={}){let n=document.head?.querySelector('meta[name="current-catalog-service"]')?.content,i=n?{service:n}:{};for(let[e,n]of Object.entries(t))null!=n&&(i[e]=`${n}`);r&&(d(i),r.sendEvent(e||"unknown",d(i)))}function p(e){return Object.fromEntries(Object.entries(e).map(([e,t])=>[e,JSON.stringify(t)]))}}}]);
//# sourceMappingURL=ui_packages_alive_alive_ts-ui_packages_favicon_favicon_ts-ui_packages_hotkey_keyboard-shortcu-30cc64-5c2cd1c07999.js.map